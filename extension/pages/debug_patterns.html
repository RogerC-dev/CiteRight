<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Pattern Debug Test</title>
    <script src="../scripts/content.js"></script>
</head>
<body>
    <h1>Pattern Debug Test</h1>
    <div id="test-content">
        <p>民法第188條第1項規定責任</p>
        <p>民法第九百六十四條、第九百六十五條</p>
        <p>釋字第五八五號解釋</p>
        <p>根據民法第188條 - 這個不應該被highlight</p>
        <p>憲法第22條~~保障人民婚姻自由及~~第7條</p>
    </div>
    
    <script>
        console.log('Starting pattern test...');
        
        // Wait for DOM to load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, testing patterns...');
            
            // Test the patterns manually
            const testTexts = [
                "民法第188條第1項",
                "民法第九百六十四條", 
                "釋字第五八五號",
                "根據民法第188條"  // Should NOT match
            ];
            
            testTexts.forEach(text => {
                console.log(`Testing: "${text}"`);
                
                // Test interpretation pattern
                const interpretationMatch = text.match(/釋字第\s*([0-9０-９一二三四五六七八九十百千萬零壹貳參肆伍陸柒捌玖拾佰仟萬]+)\s*號/g);
                if (interpretationMatch) {
                    console.log(`✅ Interpretation match: ${interpretationMatch[0]}`);
                }
                
                // Test law article pattern  
                const lawMatch = text.match(/(?<!根據|依(?!法)|按|與|宣告|主管機關基於|甲因酒駕違反|以及|及(?!法)|不符)([\u4e00-\u9fa5]{2,8}法)第\s*([0-9０-９一二三四五六七八九十百千萬零壹貳參肆伍陸柒捌玖拾佰仟萬]+(?:之[0-9０-９一二三四五六七八九十百千萬零壹貳參肆伍陸柒捌玖拾佰仟萬]+)?)\s*條(?:第\s*([0-9０-９一二三四五六七八九十百千萬零壹貳參肆伍陸柒捌玖拾佰仟萬IVXLCDM]+)\s*[項款目](?:第\s*[0-9０-９一二三四五六七八九十百千萬零壹貳參肆伍陸柒捌玖拾佰仟萬IVXLCDM]+\s*[項款目])*)?/g);
                if (lawMatch) {
                    console.log(`✅ Law match: ${lawMatch[0]}`);
                } else if (!text.includes('根據')) {
                    console.log(`❌ No law match for: ${text}`);
                }
                
                console.log('---');
            });
            
            // Try to run highlightCitations if available
            if (typeof highlightCitations === 'function') {
                console.log('Running highlightCitations...');
                highlightCitations();
            } else {
                console.log('highlightCitations function not available');
            }
        });
    </script>
</body>
</html>